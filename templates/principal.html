<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Mantenimiento</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h2>Bienvenido, {{ nombre }}</h2>
    <a href="{{ url_for('logout') }}" class="btn btn-danger mb-3">Cerrar sesión</a>

    <!-- FORMULARIO -->
    <form method="POST" class="mb-4">
        <input type="hidden" name="action" value="guardar">
        <div class="row g-3">
            <div class="col-md-3">
                <label>Sede</label>
                <select class="form-select" name="sede">
                    {% for s in sedes if s != 'Todas' %}
                    <option value="{{ s }}">{{ s }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <label>Fecha</label>
                <input type="date" class="form-control" name="fecha" value="{{ date.today().isoformat() }}">
            </div>
            <div class="col-md-3">
                <label>Área</label>
                <input type="text" class="form-control" name="area">
            </div>
            <div class="col-md-3">
                <label>Nombre máquina</label>
                <input type="text" class="form-control" name="nombre_maquina">
            </div>
            <div class="col-md-3">
                <label>Usuario</label>
                <input type="text" class="form-control" name="usuario_equipo">
            </div>
            <div class="col-md-3">
                <label>Tipo de equipo</label>
                <select class="form-select" name="tipo_equipo">
                    <option>Seleccione..</option>
                    <option>Portátil</option>
                    <option>All in One</option>
                    <option>Impresora</option>
                    <option>Computador de Escritorio</option>
                    <option>Servidor</option>
                    <option>Otro</option>
                </select>
            </div>
            <div class="col-md-3">
                <label>Marca</label>
                <input type="text" class="form-control" name="marca">
            </div>
            <div class="col-md-3">
                <label>Modelo</label>
                <input type="text" class="form-control" name="modelo">
            </div>
            <div class="col-md-3">
                <label>Serial</label>
                <input type="text" class="form-control" name="serial">
            </div>
            <div class="col-md-3">
                <label>Sistema operativo</label>
                <select class="form-select" name="so">
                    <option>Windows 10 Pro 22H2</option>
                    <option>Windows 11 Pro 23H2</option>
                    <option>Windows 11 Pro 24H2</option>
                    <option>MacOS</option>
                </select>
            </div>
            <div class="col-md-3">
                <label>Office</label>
                <select class="form-select" name="office">
                    <option>Microsoft Office 2013</option>
                    <option>Microsoft Office 365</option>
                    <option>Microsoft Office 2016</option>
                    <option>Microsoft Office 2019</option>
                    <option>Microsoft Office 2021</option>

                </select>
            </div>
            <div class="col-md-3">
                <label>Antivirus</label>
                <select class="form-select" name="antivirus">
                    <option>Kaspesky Endpoint</option>
                    <option>Windows Defender</option>
                    <option>Avast</option>
                    <option>Otro</option>
                    <option>No</option>
                </select>
            </div>
            <div class="col-md-3">
                <label>Compresor</label>
                <select class="form-select" name="compresor">
                    <option>WinRaR</option>
                    <option>7-Zip</option>
                    <option>PeaZip</option>
                </select>
            </div>
            <div class="col-md-3">
                <label>Control remoto</label>
                <select class="form-select" name="control_remoto">
                    <option>AnyDesk</option>
                    <option>TeamViewer</option>
                    <option>RuskDesk</option>
                </select>
            </div>
            <div class="col-md-3">
                <label>Activo fijo</label>
                <input type="text" class="form-control" name="activo_fijo">
            </div>
            <div class="col-md-12">
                <label>Observaciones</label>
                <textarea class="form-control" name="observaciones" rows="2"></textarea>
            </div>
        </div>
        <button type="submit" class="btn btn-primary mt-3">Guardar</button>
    </form>

    <!-- TABLA -->
    <h4>Registros</h4>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Sede</th>
                <th>Fecha</th>
                <th>Área</th>
                <th>Técnico</th>
                <th>Nombre máquina</th>
                <th>Usuario</th>
                <th>Tipo</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for r in registros %}
            <tr>
                <td>{{ r.id }}</td>
                <td>{{ r.sede }}</td>
                <td>{{ r.fecha }}</td>
                <td>{{ r.area }}</td>
                <td>{{ r.tecnico }}</td>
                <td>{{ r.nombre_maquina }}</td>
                <td>{{ r.usuario }}</td>
                <td>{{ r.tipo_equipo }}</td>
                <td>
                    <a href="{{ url_for('acta', rid=r.id) }}" class="btn btn-sm btn-success">Acta PDF</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
